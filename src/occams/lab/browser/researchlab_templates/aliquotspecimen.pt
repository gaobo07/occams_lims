<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="occams.lab"
      xml:lang="en"
      lang="en">
  <metal:content-core fill-slot="content-core">
    <metal:content-core define-macro="content-core">
      <metal:aliquot_navigation use-macro="context/labview/macros/aliquot_navigation" />
      <metal:lab_filter use-macro="context/labview/macros/lab_filter">
                  <metal:link fill-slot="filter_link">
                  <a class="lab_filter" href="./labfilter" tal:attributes="href string:${context/absolute_url}/aliquotfilter?omit=freezer&omit=rack&omit=box">
                    <img alt="Apply a filter" title="Apply a filter" src="/++resource++occams.lab/images/filter-icon.png" />
                  Apply a Filter
                  </a>
                </metal:link>
      </metal:lab_filter>
        <tal:hascontent condition="view/specimen_entry_count">
           <tal:formcontents replace="structure view/specimen_crud_form/render"   />
          <ul><li>
             <strong>Create Aliquot:</strong> Using the selected template, create COUNT aliquot, and place them in the queue below.
           </li>
            <li><strong>Mark Specimen Aliquoted</strong>: Marks selected specimens as aliquoted, and removes them from this view.
            <br /><b>NOTE:</b> If two templates are based off of the same specimen, marking one of the templates as complete will mark all
            templates for that specimen as complete.
             <br />If you complete a specimen in error, return to the <a href="./view">Arriving specimen view</a>
            and use the filter at the top of the screen: Select "Show All Samples", and enter the patient id for the patient in question.
            </li>
          </ul>
        </tal:hascontent>
        <tal:nocontent tal:condition="not:view/specimen_entry_count">
         <p>No specimen templates are currently available.  Check the <a href="./view">arriving specimen</a></p>
              <div tal:condition="view/has_filter" class="crud-form"><div class="portalMessage">You Currently have a Filter selected! This may be hiding aliquot templates from your view.</div></div>
        </tal:nocontent>
         <hr />
      <metal:crud_form use-macro="context/labview/macros/crud_form" />
        <h2 tal:condition="view/print_queue">There are currently <strong tal:content="view/print_queue">17</strong> Aliquot in the print queue. </h2>
     </metal:content-core>
  </metal:content-core>
</html>
